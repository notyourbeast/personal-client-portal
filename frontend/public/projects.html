<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Projects - Freelance ClientHub</title>
    <link rel="stylesheet" href="./assets/main.css" />
  </head>
  <body class="bg-brand-muted text-brand">
    <div class="min-h-screen flex">
      <aside class="w-64 bg-white shadow-lg p-6 hidden md:flex flex-col gap-4">
        <div>
          <p class="text-xs uppercase tracking-wide text-slate-500">Welcome</p>
          <h1 class="text-2xl font-semibold">ClientHub</h1>
        </div>
        <nav class="flex flex-col gap-2 text-sm">
          <a class="px-3 py-2 rounded-lg hover:bg-brand-muted" href="index.html">Dashboard</a>
          <a class="px-3 py-2 rounded-lg hover:bg-brand-muted" href="clients.html">Clients</a>
          <a class="px-3 py-2 rounded-lg bg-brand-accent/10 text-brand-accent font-medium" href="projects.html">Projects</a>
          <a class="px-3 py-2 rounded-lg hover:bg-brand-muted" href="#">Time Tracking</a>
          <a class="px-3 py-2 rounded-lg hover:bg-brand-muted" href="#">Invoices</a>
          <a class="px-3 py-2 rounded-lg hover:bg-brand-muted" href="#">Settings</a>
        </nav>
      </aside>
      <section class="flex-1 flex flex-col">
        <header class="bg-white shadow px-6 py-4 flex items-center justify-between">
          <div>
            <p class="text-xs uppercase tracking-wide text-slate-500">Project Management</p>
            <h2 class="text-xl font-semibold">Projects</h2>
            <p class="text-sm text-slate-500">Track funnel health and keep delivery moving.</p>
          </div>
          <div class="flex items-center gap-3">
            <button id="refreshBoardBtn" class="px-4 py-2 border border-slate-200 text-sm rounded-lg hover:bg-brand-muted transition">
              Refresh
            </button>
            <button id="addProjectBtn" class="px-4 py-2 bg-brand-accent text-white rounded-lg hover:bg-blue-700 transition">
              + Add Project
            </button>
          </div>
        </header>

        <main class="flex-1 p-6 space-y-6 overflow-x-auto">
          <section class="grid gap-4 md:grid-cols-2 xl:grid-cols-4">
            <article class="bg-white rounded-xl shadow p-4">
              <p class="text-xs uppercase tracking-wide text-slate-500">Total Projects</p>
              <p class="text-3xl font-semibold mt-2" id="statTotalProjects">0</p>
              <p class="text-xs text-slate-400 mt-1">All initiatives in the pipeline</p>
            </article>
            <article class="bg-white rounded-xl shadow p-4">
              <p class="text-xs uppercase tracking-wide text-slate-500">Active Work</p>
              <p class="text-3xl font-semibold mt-2" id="statActiveProjects">0</p>
              <p class="text-xs text-slate-400 mt-1">Talks ‚Üí Review stages</p>
            </article>
            <article class="bg-white rounded-xl shadow p-4">
              <p class="text-xs uppercase tracking-wide text-slate-500">Due Soon</p>
              <p class="text-3xl font-semibold mt-2" id="statDueSoon">0</p>
              <p class="text-xs text-slate-400 mt-1">Deadlines within 7 days</p>
            </article>
            <article class="bg-white rounded-xl shadow p-4">
              <p class="text-xs uppercase tracking-wide text-slate-500">Avg. Hourly Rate</p>
              <p class="text-3xl font-semibold mt-2" id="statAverageRate">$0</p>
              <p class="text-xs text-slate-400 mt-1">Across active projects</p>
            </article>
          </section>

          <section class="bg-white rounded-xl shadow p-4 space-y-4">
            <div class="flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between">
              <div class="flex flex-col gap-3 md:flex-row md:items-center">
                <div class="relative md:w-72">
                  <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-slate-400 pointer-events-none">üîç</span>
                  <input
                    id="searchProjects"
                    type="text"
                    placeholder="Search title or client..."
                    class="w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-accent"
                  />
                </div>
                <select
                  id="boardClientFilter"
                  class="w-full md:w-56 px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-accent"
                >
                  <option value="">All clients</option>
                </select>
              </div>
              <div class="flex items-center gap-3">
                <button id="clearFiltersBtn" class="px-3 py-2 text-sm border border-slate-200 rounded-lg hover:bg-brand-muted transition">
                  Reset filters
                </button>
                <span class="text-xs text-slate-400 hidden md:inline-flex">
                  Tip: Update stage via quick actions on each card.
                </span>
              </div>
            </div>
            <div class="flex flex-wrap gap-2" id="statusFilterChips">
              <button class="px-3 py-1 text-xs rounded-full border border-slate-200 bg-white text-slate-600 shadow-sm status-chip active" data-status="idea">
                Idea
              </button>
              <button class="px-3 py-1 text-xs rounded-full border border-slate-200 bg-white text-slate-600 shadow-sm status-chip active" data-status="talks">
                Talks
              </button>
              <button class="px-3 py-1 text-xs rounded-full border border-slate-200 bg-white text-slate-600 shadow-sm status-chip active" data-status="in-progress">
                In Progress
              </button>
              <button class="px-3 py-1 text-xs rounded-full border border-slate-200 bg-white text-slate-600 shadow-sm status-chip active" data-status="review">
                Review
              </button>
              <button class="px-3 py-1 text-xs rounded-full border border-slate-200 bg-white text-slate-600 shadow-sm status-chip active" data-status="completed">
                Completed
              </button>
            </div>
          </section>

          <div id="boardEmptyState" class="hidden bg-white rounded-xl shadow p-10 text-center">
            <h3 class="text-xl font-semibold mb-2">No projects yet</h3>
            <p class="text-slate-500 mb-4">Start by adding your first client project to visualize your funnel.</p>
            <button class="px-4 py-2 bg-brand-accent text-white rounded-lg hover:bg-blue-700 transition" onclick="document.getElementById('addProjectBtn').click()">
              Create project
            </button>
          </div>

          <div id="kanbanBoard" class="flex gap-4 min-w-max relative">
            <div id="boardLoadingOverlay" class="hidden absolute inset-0 bg-white/70 backdrop-blur-sm rounded-xl z-10">
              <div class="h-full w-full flex items-center justify-center">
                <div class="animate-spin rounded-full h-12 w-12 border-4 border-brand-accent border-t-transparent"></div>
              </div>
            </div>
            <div class="kanban-column" data-status="idea">
              <div class="bg-white rounded-xl shadow p-4 min-w-[280px]">
                <div class="flex items-center justify-between mb-2">
                  <h3 class="font-semibold text-sm uppercase tracking-wide text-slate-600">Idea</h3>
                  <span class="text-xs bg-brand-muted px-2 py-1 rounded-full text-slate-600" data-column-count="idea">0</span>
                </div>
                <p class="text-xs text-slate-400 mb-4">Lead intake & discovery thoughts.</p>
                <div class="space-y-3" id="column-idea"></div>
              </div>
            </div>
            <div class="kanban-column" data-status="talks">
              <div class="bg-white rounded-xl shadow p-4 min-w-[280px]">
                <div class="flex items-center justify-between mb-2">
                  <h3 class="font-semibold text-sm uppercase tracking-wide text-slate-600">Talks</h3>
                  <span class="text-xs bg-brand-muted px-2 py-1 rounded-full text-slate-600" data-column-count="talks">0</span>
                </div>
                <p class="text-xs text-slate-400 mb-4">Scoping calls & proposal drafting.</p>
                <div class="space-y-3" id="column-talks"></div>
              </div>
            </div>
            <div class="kanban-column" data-status="in-progress">
              <div class="bg-white rounded-xl shadow p-4 min-w-[280px]">
                <div class="flex items-center justify-between mb-2">
                  <h3 class="font-semibold text-sm uppercase tracking-wide text-slate-600">In Progress</h3>
                  <span class="text-xs bg-brand-muted px-2 py-1 rounded-full text-slate-600" data-column-count="in-progress">0</span>
                </div>
                <p class="text-xs text-slate-400 mb-4">Execution & time tracking.</p>
                <div class="space-y-3" id="column-in-progress"></div>
              </div>
            </div>
            <div class="kanban-column" data-status="review">
              <div class="bg-white rounded-xl shadow p-4 min-w-[280px]">
                <div class="flex items-center justify-between mb-2">
                  <h3 class="font-semibold text-sm uppercase tracking-wide text-slate-600">Review</h3>
                  <span class="text-xs bg-brand-muted px-2 py-1 rounded-full text-slate-600" data-column-count="review">0</span>
                </div>
                <p class="text-xs text-slate-400 mb-4">Client feedback & revisions.</p>
                <div class="space-y-3" id="column-review"></div>
              </div>
            </div>
            <div class="kanban-column" data-status="completed">
              <div class="bg-white rounded-xl shadow p-4 min-w-[280px]">
                <div class="flex items-center justify-between mb-2">
                  <h3 class="font-semibold text-sm uppercase tracking-wide text-slate-600">Completed</h3>
                  <span class="text-xs bg-brand-muted px-2 py-1 rounded-full text-slate-600" data-column-count="completed">0</span>
                </div>
                <p class="text-xs text-slate-400 mb-4">Delivery sent & invoiced.</p>
                <div class="space-y-3" id="column-completed"></div>
              </div>
            </div>
          </div>
        </main>
      </section>
    </div>

    <!-- Add/Edit Modal -->
    <div id="projectModal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
      <div class="bg-white rounded-xl shadow-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-4">
          <h3 id="modalTitle" class="text-xl font-semibold">Add Project</h3>
          <button id="closeModalBtn" class="text-slate-400 hover:text-slate-600">‚úï</button>
        </div>
        <form id="projectForm" class="space-y-4">
          <input type="hidden" id="projectId" />
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-1">Client *</label>
            <select
              id="projectClientId"
              required
              class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-accent"
            >
              <option value="">Select a client...</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-1">Title *</label>
            <input
              type="text"
              id="projectTitle"
              required
              class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-accent"
            />
          </div>
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-1">Description</label>
            <textarea
              id="projectDescription"
              rows="3"
              class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-accent"
            ></textarea>
          </div>
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-1">Status</label>
            <select
              id="projectStatus"
              class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-accent"
            >
              <option value="idea">Idea</option>
              <option value="talks">Talks</option>
              <option value="in-progress">In Progress</option>
              <option value="review">Review</option>
              <option value="completed">Completed</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-1">Hourly Rate ($)</label>
            <input
              type="number"
              id="projectHourlyRate"
              step="0.01"
              min="0"
              class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-accent"
            />
          </div>
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-1">Deadline</label>
            <input
              type="datetime-local"
              id="projectDeadline"
              class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-accent"
            />
          </div>
          <div class="flex gap-3 pt-2">
            <button type="submit" class="flex-1 px-4 py-2 bg-brand-accent text-white rounded-lg hover:bg-blue-700 transition">
              Save
            </button>
            <button type="button" id="cancelBtn" class="flex-1 px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition">
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>

    <div id="projectToast" class="hidden fixed bottom-6 right-6 bg-white border border-slate-200 shadow-xl rounded-xl px-4 py-3 text-sm text-slate-700"></div>

    <script src="./assets/projects.js"></script>
  </body>
</html>
